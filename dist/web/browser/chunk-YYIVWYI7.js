import{a as Ae}from"./chunk-57NOG5XR.js";import{c as Ue}from"./chunk-P6JLYCKV.js";import"./chunk-6WPNMGAC.js";import{$a as Ce,$b as Me,A as le,B as ce,Da as w,E as de,H as me,L as pe,Ma as ue,N as _e,Na as ge,Nb as we,O as B,Oa as he,P as b,Pa as fe,Q as c,Qa as ve,Qb as Ee,R as J,Rb as Te,Sb as Le,Sc as H,Tc as Y,Ub as K,Vb as De,ab as ye,ad as Ie,ic as qe,na as v,q as z,s as P,u as j,v as se,wc as ke,z as f}from"./chunk-IAI7ZALY.js";import{O as $,R as Se,aa as xe,ba as be}from"./chunk-PS3DXR7F.js";import"./chunk-JKO3ADSL.js";import{$b as R,Ac as ne,Bc as oe,Cc as m,Db as a,Dc as L,Eb as S,Ec as O,Ga as k,Id as re,Kc as U,La as E,Lc as A,Ma as T,Mc as ae,Pb as u,Qd as G,Rc as M,Sc as q,Xb as g,Yb as h,Zb as V,_b as F,a as N,bc as ee,fc as te,gc as r,hc as o,ic as _,mc as I,n as W,tc as y,ub as x,vc as p,yc as ie,zc as D}from"./chunk-G7L63APJ.js";var Fe=(()=>{let s=class s{constructor(){}ngOnInit(){}};s.\u0275fac=function(n){return new(n||s)},s.\u0275cmp=k({type:s,selectors:[["app-property-managers"]],standalone:!0,features:[U],decls:1,vars:0,template:function(n,l){n&1&&_(0,"router-outlet")},dependencies:[Se]});let e=s;return e})();var Q=()=>({height:"10px",width:"100%"}),$e=()=>({height:"15px",width:"100%"});function Ke(e,s){e&1&&(r(0,"div",20)(1,"div",7)(2,"div",8),_(3,"ngx-skeleton-loader",21),o(),r(4,"div",8),_(5,"ngx-skeleton-loader",21),o(),r(6,"div",8),_(7,"ngx-skeleton-loader",21),o()(),r(8,"div",22),_(9,"ngx-skeleton-loader",23),o()()),e&2&&(a(3),u("theme",A(4,Q)),a(2),u("theme",A(5,Q)),a(2),u("theme",A(6,Q)),a(2),u("theme",A(7,$e)))}function He(e,s){if(e&1&&F(0,Ke,10,8,"div",24,V),e&2){let i=p();R(i.gs.generateFake(3))}}var Ye=()=>[import("./chunk-VCXSO2A7.js").then(e=>e.SearchManagersListingItemComponent)];function We(e,s){if(e&1&&_(0,"div",26),e&2){let i=p().$implicit;u("item",i)}}function Je(e,s){e&1&&(r(0,"div",27),m(1,"Wait for the duck..."),o())}function Qe(e,s){e&1&&(g(0,We,1,1)(1,Je,2,0),ee(2,0,Ye,null,1),te(0,-1))}function Xe(e,s){if(e&1&&(r(0,"div",28),_(1,"img",29),o()),e&2){let i=p(2);a(1),D("src","",i.gs.imgUrl,"/managers-notfound.svg",x)}}function Ze(e,s){if(e&1){let i=I();r(0,"div",30)(1,"app-pagination",31),y("getPage",function(n){E(i);let l=p(2);return T(l.handlePagination(n))}),M(2,"async"),o()()}if(e&2){let i=p(2);a(1),u("pagination",q(2,2,i.users))("page",+i.page+1)}}function et(e,s){if(e&1&&(F(0,Qe,4,0,null,null,V,!1,Xe,2,1),M(3,"async"),g(4,Ze,3,4,"div",25),M(5,"async")),e&2){let i=p(),t,n;R((t=q(3,2,i.users))==null?null:t.items),a(4),h(4,((n=q(5,4,i.users))==null?null:n.total)>i.params.size?4:-1)}}var tt=()=>({standalone:!0}),Re=(()=>{let s=class s{constructor(t,n,l,d,C){this.gs=t,this.activeRoute=n,this.router=l,this.confirmDialog=d,this.itemService=C,this.users=this.gs.store.select(w.UserSelectors[c.User.search]),this.loading=this.gs.store.select(w.UserLoadingKey[`${c.User.search}Loading`]),this.countriesObservable=this.gs.store.select(w.DefaultSelectors[c.Default.countries]),this.stateObservable=this.gs.store.select(w.DefaultSelectors[c.Default.states]),this.citiesObservable=this.gs.store.select(w.DefaultSelectors[c.Default.cities]),this.citiesLoading=this.gs.store.select(w.DefaultLoadingKey[`${c.Default.cities}Loading`]),this.q="",this.q_location="",this.q_location_country_code="",this.q_location_state_code="",this.q_location_city="",this.q_location_zip5="",this.q_location_zip4="",this.sort="",this.page=1,this.params={key:c.User.search,roles:b.Role.ROLE_MANAGERS,page:0,size:10},this.modelChanged=new W,this.state_code="",this.city_page=0,this.citieInput$=new W,this.show_clear=!1}ngOnInit(){this.loadActiveRoute()}loadActiveRoute(){this.activeRoute.queryParamMap.subscribe(t=>{let n=t.get("q")??"",l=t.get("q_location")??null,d=t.get("q_location_country_code")??null,C=t.get("q_location_state_code")??null,Ne=t.get("q_location_city")??null,X=t.get("sort")??"-id",Z=t.get("page")??0;this.q=n,this.q_location=l,this.q_location_country_code=d,this.q_location_state_code=C,this.q_location_city=Ne,this.sort=X,this.page=Z,this.state_code=t.get("q_location_state_code")||"",this.params=Object.assign({},this.params,{q:n,q_location:l,sort:X,page:Z});let Oe=v.UserParams({method:"GET",params:null,params2:this.params,key:c.User.search});this.gs.store.dispatch(Oe)})}loadState(t){this.gs.store.dispatch(v.DefaultParams({method:"GET",params:null,params2:{country_iso2:t,key:c.Default.states,size:1e3},key:c.Default.states}))}onScroll(t){}onScrollToEnd(){this.city_page+=1,this.gs.store.dispatch(v.DefaultMoreParams({method:"GET",params:null,params2:{state_code:this.state_code,page:this.city_page,key:c.Default.cities,size:100},key:c.Default.cities}))}loadCity(t,n=""){this.gs.store.dispatch(v.DefaultParams({method:"GET",params:null,params2:{state_code:t,q:n,key:c.Default.cities,page:0,size:20},key:c.Default.cities}))}handleCountries(t){t?(this.q_location_country_code=t?.iso2,this.loadState(t?.iso2),this.q_location_state_code=null,this.q_location_city=null):(this.q_location_country_code=null,this.q_location_state_code=null,this.q_location_city=null,this.gs.store.dispatch(v.DefaultAdd({item:null,key:c.Default.cities})),this.gs.store.dispatch(v.DefaultAdd({item:null,key:c.Default.states}))),this.search()}handleState(t){this.state_code=t?.state_code||"",t?(this.q_location_state_code=t?.state_code,this.loadCity(t?.state_code)):(this.q_location_state_code=null,this.q_location_city=null,this.gs.store.dispatch(v.DefaultAdd({item:null,key:c.Default.cities}))),this.search()}handleCity(t){this.q_location_city=t?t.name:null,this.search()}handleAddressChange(t){let n=Ie(t);console.log("address",t,n),this.q_location=n.location}search(){this.q?.length>0&&(this.show_clear=!0),this.router.navigate(["/property-managers/listing"],{queryParams:{q:this.q,q_location:this.q_location,sort:this.sort,page:this.page},queryParamsHandling:"merge"})}handlePagination(t){this.page=t,this.router.navigate(["/property-managers/listing"],{queryParams:{page:t-1},queryParamsHandling:"merge"})}};s.\u0275fac=function(n){return new(n||s)(S(H),S($),S(xe),S(K),S(Y))},s.\u0275cmp=k({type:s,selectors:[["app-search-managers-listing"]],standalone:!0,features:[U],decls:26,vars:8,consts:[[1,"search-property-managers-listing"],["aria-label","breadcrumb"],[1,"breadcrumb"],[1,"breadcrumb-item"],["routerLink","/"],["aria-current","page",1,"breadcrumb-item","active"],[1,"filter"],[1,"row"],[1,"col-sm-4"],[1,"form-group-1","position-relative"],[1,"input-group"],["type","text","name","name","placeholder","Search",1,"form-control",3,"ngModel","ngModelOptions","ngModelChange","keyup.enter"],[1,"col-sm-8"],[1,"select11"],[3,"value","onAddressChange"],["type","submit",1,"btn","btn-primary",3,"click"],["alt","Search",3,"src"],[1,"btndiv"],["routerLink","/property-managers/listing",3,"click"],[1,"search-result"],[1,"spmbox"],["count","2",3,"theme"],[1,"content"],["count","3",3,"theme"],["class","spmbox"],["class","handle-pagination"],["app-search-managers-listing-item","",1,"spmbox",3,"item"],[2,"height","300px","width","300px"],[1,"notfound"],["alt","Images",3,"src"],[1,"handle-pagination"],[3,"pagination","page","getPage"]],template:function(n,l){if(n&1&&(r(0,"div",0)(1,"nav",1)(2,"ol",2)(3,"li",3)(4,"a",4),m(5,"Home"),o()(),r(6,"li",5),m(7," Search Property Managers "),o()()(),r(8,"div",6)(9,"div",7)(10,"div",8)(11,"div",9)(12,"div",10)(13,"input",11),y("ngModelChange",function(C){return l.q=C})("keyup.enter",function(){return l.search()}),o()()()(),r(14,"div",12)(15,"div",13)(16,"app-google-location-input",14),y("onAddressChange",function(C){return l.handleAddressChange(C)}),o(),r(17,"button",15),y("click",function(){return l.search()}),_(18,"img",16),o()(),r(19,"div",17)(20,"a",18),y("click",function(){return l.show_clear=!1}),m(21,"Clear"),o()()()()(),r(22,"div",19),g(23,He,2,0),M(24,"async"),g(25,et,6,6),o()()),n&2){let d;a(13),u("ngModel",l.q)("ngModelOptions",A(7,tt)),a(3),u("value",(d=l.q_location)!==null&&d!==void 0?d:""),a(2),D("src","",l.gs.imgUrl,"/search-meg-2.svg",x),a(5),h(23,q(24,5,l.loading)?23:25)}},dependencies:[B,z,j,_e,le,qe,ye,Ce,De,G,be,ke]});let e=s;return e})();function it(e,s){e&1&&(r(0,"div",8)(1,"h1",9),m(2),o()()),e&2&&(a(2),L("This url not valid."))}function nt(e,s){if(e&1&&(r(0,"div",11)(1,"div",12)(2,"div",13)(3,"div",14),_(4,"img",15)(5,"div",16),o()(),r(6,"div",17)(7,"div",18)(8,"h3"),m(9),o(),r(10,"div",19),_(11,"img",20),o(),r(12,"div",21),m(13,"(Real Estate Group)"),o(),r(14,"div",22),m(15,"Saudi Arabia, Riyadh City"),o()()()()()),e&2){let i=p(2);a(4),u("src",i.item==null?null:i.item.avatar,x),a(5),L(i.item==null?null:i.item.name),a(2),D("src","",i.gs.imgUrl,"/rat-badge.svg",x)}}function ot(e,s){e&1&&(r(0,"div",8)(1,"h1",9),m(2),o()()),e&2&&(a(2),L("This url not valid."))}function at(e,s){if(e&1&&(r(0,"div",19),_(1,"img",20),o()),e&2){let i=p(4);a(1),D("src","",i.gs.imgUrl,"/rat-badge.svg",x)}}var rt=e=>({text:e});function st(e,s){if(e&1){let i=I();r(0,"div",25)(1,"div",12)(2,"div",13)(3,"div",14),_(4,"img",15),o()(),r(5,"div",17)(6,"div",18)(7,"div",26)(8,"button",27),y("click",function(){E(i);let n=p(3);return T(n.handleFavourite(n.item))}),_(9,"img",20),m(10,"Favorite "),o()(),r(11,"h3"),m(12),o(),g(13,at,2,1,"div",28),r(14,"div",21),m(15),o(),r(16,"div",22),m(17),o()()()()()}if(e&2){let i=p(3),t;a(4),u("src",i.item.avatar,x),a(4),u("ngClass",ae(9,rt,i.item.is_favorite))("appLadda",i.favourileLoading),a(1),ne("src","",i.gs.imgUrl,"/",i.item.is_favorite?"heart-hor.svg":"heart-nor.svg","",x),a(3),L(i.item.name),a(1),h(13,i.item.badge?13:-1),a(2),L(i.item.title?i.item.title:i.gs.removeLastS(i.item.role)),a(2),O(" ",(t=(t=i.item)==null||t.location==null?null:t.location.location)!==null&&t!==void 0?t:"-"," ")}}function lt(e,s){if(e&1){let i=I();r(0,"li")(1,"a",48),y("click",function(){let l=E(i).$implicit,d=p(4);return T(d.form.patchValue({type_of_request:l.value}))}),m(2),o()()}if(e&2){let i=s.$implicit;a(2),L(i.value)}}function ct(e,s){if(e&1&&(r(0,"div",49),m(1),o()),e&2){let i=p(4);a(1),O(" ",i.gs.maxLength-(i.form.value==null||i.form.value.description==null?null:i.form.value.description.length)," characters left ")}}function dt(e,s){e&1&&(r(0,"div"),m(1),o()),e&2&&(a(1),L("Attachment is required"))}function mt(e,s){if(e&1&&(r(0,"div",50),g(1,dt,2,1,"div"),o()),e&2){let i=p(4);a(1),h(1,i.f.doc_id.errors&&i.f.doc_id.errors.required?1:-1)}}function pt(e,s){if(e&1){let i=I();r(0,"div",29)(1,"form",30),y("ngSubmit",function(){E(i);let n=p(3);return T(n.onSubmit(n.form))}),r(2,"div",31)(3,"div",32)(4,"input",33),y("click",function(){E(i);let n=oe(7);return T(n.open())}),o(),r(5,"span",34)(6,"div",35,36)(8,"button",37)(9,"span",38),_(10,"img",20),o()(),r(11,"ul",39),F(12,lt,3,1,"li",null,V),o()()()()(),r(14,"div",40),_(15,"textarea",41),g(16,ct,2,1,"div",42),o(),r(17,"div",43)(18,"app-file-drag-drop-uploader",44),y("getFileId",function(n){E(i);let l=p(3);return T(l.form.patchValue({doc_id:n[0]}))}),o(),g(19,mt,2,1,"div",45),o(),r(20,"div",46)(21,"button",47),m(22),o()()()()}if(e&2){let i=p(3);a(1),u("formGroup",i.form),a(9),D("src","",i.gs.imgUrl,"/dropdown-arrow.svg",x),a(2),R(i.TypeOfRequestArray),a(3),ie("maxlength",i.gs.maxLength),a(1),h(16,i.form.value!=null&&i.form.value.description?16:-1),a(2),u("layout","inline")("browseLabel","+ Add attachment...")("multiple",!1)("accept",".xlsx,.xls,image/*,.doc, .docx,.ppt, .pptx,.pdf")("hint","Accepted file formats: .pdf, .docx, .xls, .png, .jpeg.")("checkExtensions",!0)("extensions","image_doc"),a(1),h(19,i.gs.isValid("doc_id",i.f)?19:-1),a(2),u("appLadda",i.loading),a(1),O(" ",i.item.in_contact===i.Enums.USER_PROFILE_CONTACT_STATUS_DECLINED?"Re-Submit":"Send"," ")}}function _t(e,s){if(e&1&&g(0,ot,3,1,"div",7)(1,st,18,11,"div",23)(2,pt,23,14,"div",24),e&2){let i=p(2);h(0,i.item===null?0:-1),a(1),h(1,i.item?1:-1),a(1),h(2,i.item?2:-1)}}function ut(e,s){if(e&1&&(r(0,"div",8),g(1,nt,16,3,"div",10),M(2,"async"),g(3,_t,3,3),o()),e&2){let i=p();a(1),h(1,q(2,1,i.loadingView)?1:3)}}var Pe=(()=>{let s=class s{get f(){return this.form.controls}constructor(t,n,l,d){this.gs=t,this.route=n,this.confirmDialog=l,this.itemService=d,this.userObservable=this.gs.store.select(w.UserSelectors[c.User.view]),this.loadingView=this.gs.store.select(w.UserLoadingKey[`${c.User.view}Loading`]),this.loading=!1,this.favourileLoading=!1,this.item_id=null,this.item=null,this.CatalogRxKey=c.User,this.role=b.Role,this.showError=!1,this.TypeOfRequestArray=J.CatalogRefRequestTypeArray,this.type="",this.Enums=b,this.contact=null,this.item_id=n.snapshot.params.id}ngOnInit(){this.onLoadUser(),this.formValidation(),this.userObservable.subscribe(t=>{this.item=t,t&&(t?.role,b.ROLE_MANAGERS),t?.in_contact===b.USER_PROFILE_CONTACT_STATUS_DECLINED&&this.onLoadContact()})}onLoadUser(){let t={username:this.item_id},n=v.UserParams({method:"GET",params:null,params2:t,key:c.User.view});this.gs.store.dispatch(n)}onLoadContact(){this.itemService.contact("GET",null,{primary_id:this.item?.contact_id}).subscribe(t=>{this.contact=t.data,t.data&&this.form.patchValue({description:this.contact?.description,type_of_request:this.contact?.type_of_request,doc_id:this.contact?.doc_id,status:b.USER_PROFILE_CONTACT_STATUS_RESUBMITTED})})}formValidation(){this.form=this.gs.formBuilder.group({user_id:new f(""),contact_id:new f(""),location_id:new f(""),type_of_request:new f("",[P.required]),description:new f("",[P.required,P.maxLength(this.gs.maxLength)]),doc_id:new f(0),relation:new f(J.USER_CATALOG_ROLE_MANAGER),name:new f(""),email:new f(""),gender:new f(""),date_of_birth:new f(""),telephone:new f(""),status:new f(b.USER_PROFILE_CONTACT_STATUS_PENDING,[P.required])})}onSubmit(t){if(!this.form.valid){this.gs.validateAllFormFields(this.form);return}if(this.item?.role!==b.ROLE_MANAGERS){this.confirmDialog.confirm({message:this.gs.translate("Contact only prorperty manager"),rejectVisible:!0,acceptLabel:"Ok"},()=>{console.log("Yes clicked")},()=>console.log("No clicked"));return}let n=N({},t.value);n.user_id=this.gs.identity?.id,n.contact_id=this.item.id,n.location_id=this.item.userProfile.location_id,n.name=this.gs.identity?.name,n.email=this.gs.identity?.email,n.gender=this.gs.identity?.userProfile.gender,n.date_of_birth=this.gs.identity?.userProfile.date_of_birth,n.telephone=this.gs.identity?.userProfile.telephone,this.loading=!0;let l=this.contact?{primary_id:this.contact?.id}:null;this.itemService.contact("POST",{form:n},l).subscribe(d=>{let C=d.data;this.loading=!1,this.gs.alert("You have successfully sent a contact request to the Property Manager"),this.gs.store.dispatch(v.ProfileParams({method:"GET",params:null,params2:{primary_id:this.gs.identity?.id},key:"load_profile"})),this.gs.router(`/requests/contact/view/${C?.id}`)},d=>{this.loading=!1})}handleFavourite(t){if(this.gs.identity===null){this.confirmDialog.confirmThis("Login Required",()=>{this.gs.router("/login")},()=>{console.log("No clicked")});return}if(t.is_favorite)this.confirmDialog.confirm({header:this.gs.translate("Remove Favorite?"),icon:`<img src="${this.gs.imgUrl}/reject.svg" alt="" />`,message:this.gs.translate("Are you sure you want to remove favorite list?")},()=>{this.favourileLoading=!0;let n={favorite_id:t.id,key:c.User.favorite};this.itemService.profile("DELETE",null,n).subscribe(l=>{this.favourileLoading=!1;let d=N({},this.item);d.is_favorite=!1,this.gs.store.dispatch(v.UserList({data:d,key:c.User.view})),this.gs.alert("You have successfully removed this manager from your favorites list.","danger")},l=>{this.favourileLoading=!1})},()=>console.log("No clicked"));else{this.favourileLoading=!0;let n={user_id:this.gs.identity.id,favorite_id:t.id,moduleId:"UserProfile"},l={key:c.User.favorite};this.itemService.profile("POST",{form:n},l).subscribe(d=>{this.favourileLoading=!1;let C=N({},this.item);C.is_favorite=!0,this.gs.store.dispatch(v.UserList({data:C,key:c.User.view})),this.gs.alert("You have successfully added this manager to your favorites list.")},d=>{this.favourileLoading=!1})}}ngOnDestroy(){this.gs.store.dispatch(v.UserList({data:null,key:c.User.view}))}};s.\u0275fac=function(n){return new(n||s)(S(H),S($),S(K),S(Y))},s.\u0275cmp=k({type:s,selectors:[["app-search-managers-view"]],standalone:!0,features:[U],decls:12,vars:2,consts:[[1,"search-property-managers-view"],["aria-label","breadcrumb"],[1,"breadcrumb"],[1,"breadcrumb-item"],["href","#"],["aria-current","page",1,"breadcrumb-item"],["aria-current","page",1,"breadcrumb-item","active"],["class","w-100"],[1,"w-100"],[1,"text-danger"],["class","spmbox","style","opacity: 0.8"],[1,"spmbox",2,"opacity","0.8"],[1,"row"],[1,"col-sm-2"],[1,"image"],["alt","Profile",3,"src"],[1,"online"],[1,"col-sm-10"],[1,"detail"],[1,"ratebadge"],["alt","",3,"src"],[1,"desina"],[1,"address"],["class","spmbox"],["class","formdiv"],[1,"spmbox"],[1,"faveritesbtn"],["type","button",1,"faverites",3,"ngClass","appLadda","click"],["class","ratebadge"],[1,"formdiv"],[3,"formGroup","ngSubmit"],[1,"form-group"],["controlErrorContainer","",1,"input-group"],["type","text","formControlName","type_of_request","placeholder","Type of Request","name","Type of requests","readonly","",1,"form-control",3,"click"],["id","basic-addon2",1,"input-group-text"],["ngbDropdown",""],["myDrop","ngbDropdown"],["type","button","ngbDropdownToggle","","ngbDropdownAnchor",""],[1,"name"],["ngbDropdownMenu",""],[1,"form-group-1"],["placeholder","Description","name","Description","cols","30","rows","10","formControlName","description",1,"form-control",3,"maxlength"],["class","crtcount"],[1,"form-group","filesupload"],["title","",3,"layout","browseLabel","multiple","accept","hint","checkExtensions","extensions","getFileId"],["class","invalid-feedback d-block"],[1,"btndiv"],["type","submit",1,"btn","btn-primary",3,"appLadda"],["ngbDropdownItem","",3,"click"],[1,"crtcount"],[1,"invalid-feedback","d-block"]],template:function(n,l){n&1&&(r(0,"div",0)(1,"nav",1)(2,"ol",2)(3,"li",3)(4,"a",4),m(5,"Home"),o()(),r(6,"li",5),m(7," Search Property Managers "),o(),r(8,"li",6),m(9," Contact Manager "),o()()(),g(10,it,3,1,"div",7)(11,ut,4,3,"div",7),o()),n&2&&(a(10),h(10,l.showError?10:-1),a(1),h(11,l.showError?-1:11))},dependencies:[re,we,B,ce,z,j,se,pe,de,me,Te,Ee,Le,ve,fe,he,ge,ue,Me,G]});let e=s;return e})();var Ht=[{path:"",component:Ue,canActivate:[Ae],children:[{path:"property-managers",redirectTo:"property-managers/listing"},{path:"property-managers",component:Fe,children:[{path:"listing",component:Re,title:"Property Listing"},{path:"view/:id",component:Pe,title:"Property View"}]}]}];export{Ht as default};
