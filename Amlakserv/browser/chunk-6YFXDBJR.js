import{d as me,f as ce}from"./chunk-SYH3CHID.js";import{$b as se,B as G,E as P,H as j,L as re,Ma as z,N as ae,Na as B,Nb as K,O as $,Oa as W,P as E,Pa as Y,Qa as H,Qb as Q,R as h,Ra as J,Rb as X,Sb as Z,Sc as ee,Tc as te,ac as de,na as le,q as L,s as m,u as M,v as O,z as i}from"./chunk-CKIWQN5W.js";import{$b as k,Bc as U,Cc as u,Db as a,Dc as q,Eb as f,Ec as ie,Ga as I,Kc as V,La as C,Ma as b,Pb as _,Xb as N,Yb as A,Zb as x,Zd as ne,_b as F,a as R,gc as o,hc as n,ic as g,mc as w,tc as p,ub as y,vc as S,yc as oe,zc as D}from"./chunk-UT4UL2LR.js";function _e(r,l){if(r&1){let s=w();o(0,"li")(1,"a",20),p("click",function(){let e=C(s).$implicit,c=S();return b(c.form.patchValue({type_of_request:e.value}))}),u(2),n()()}if(r&2){let s=l.$implicit;a(2),q(s.value)}}var Re=(()=>{let l=class l{constructor(d,t,e){this.gs=d,this.activeModal=t,this.itemService=e,this.item=null,this.contactUser=null,this.relation=h.USER_CATALOG_ROLE_MANAGER,this.submitted=!1,this.loading=!1,this.TypeOfRequestArray=h.CatalogRefRequestTypeArray}get f(){return this.form.controls}ngOnInit(){this.form=this.gs.formBuilder.group({user_id:new i(this.gs.identity?.id),contact_id:new i(this.contactUser?.id),location_id:new i(this.item?.location_id),type_of_request:new i("",[m.required]),description:new i("",[m.required]),doc_id:new i(""),relation:new i(this.relation),name:new i(this.gs.identity?.name),email:new i(this.gs.identity?.email,[m.required,m.email]),gender:new i(this.gs.identity?.gender),date_of_birth:new i(this.gs.identity?.userProfile.date_of_birth),telephone:new i(this.gs.identity?.userProfile.telephone,[m.required]),status:new i(E.USER_PROFILE_CONTACT_STATUS_PENDING,[m.required])})}onSubmit(d){if(this.submitted=!0,!d.valid){this.submitted=!1,this.gs.validateAllFormFields(this.form);return}this.gs.clearErrorMessages();let t=R({},d.value);this.loading=!0;let e={key:"request"};this.itemService.userContact("POST",{UserProfileContactForm:t},null).subscribe(c=>{this.loading=!1,this.gs.alert(`You have successfully send the contact request to ${this.relation}`),this.activeModal.close()},c=>{this.loading=!1})}};l.\u0275fac=function(t){return new(t||l)(f(ee),f(J),f(te))},l.\u0275cmp=I({type:l,selectors:[["app-catalog-contact-dialog"]],inputs:{item:"item",contactUser:"contactUser",relation:"relation"},standalone:!0,features:[V],decls:30,vars:4,consts:[[1,"modal-body"],["type","button",1,"close",3,"click"],["alt","Close",3,"src"],[1,"readytoapply-popup"],["novalidate","",3,"formGroup","ngSubmit"],[1,"form-group"],["controlErrorContainer","",1,"input-group"],["type","text","formControlName","type_of_request","placeholder","Type of Request","name","Type of requests","readonly","",1,"form-control",3,"click"],["id","basic-addon2",1,"input-group-text"],["ngbDropdown",""],["myDrop","ngbDropdown"],["type","button","ngbDropdownToggle","","ngbDropdownAnchor",""],[1,"name"],["alt","",3,"src"],["ngbDropdownMenu",""],["placeholder","Why would you like to apply for this property? (optional)","formControlName","description",1,"form-control"],[1,"row"],[1,"col-sm-12"],[1,"btndivtwo"],["type","submit",1,"btn","btn-primary",3,"appLadda"],["ngbDropdownItem","",3,"click"]],template:function(t,e){if(t&1){let c=w();o(0,"div",0)(1,"button",1),p("click",function(){return e.activeModal.dismiss()}),g(2,"img",2),n(),o(3,"h1"),u(4,"Ready to Contact?"),n(),o(5,"div",3)(6,"form",4),p("ngSubmit",function(){return e.onSubmit(e.form)}),g(7,"app-error-summary"),o(8,"div",5)(9,"div",6)(10,"input",7),p("click",function(){C(c);let T=U(13);return b(T.open())}),n(),o(11,"span",8)(12,"div",9,10)(14,"button",11)(15,"span",12),g(16,"img",13),n()(),o(17,"ul",14),F(18,_e,3,1,"li",null,x),n()()()()(),o(20,"div",5)(21,"label"),u(22,"Enter your message"),n(),g(23,"textarea",15),n(),o(24,"div",16)(25,"div",17)(26,"div",5)(27,"div",18)(28,"button",19),u(29," Send Request "),n()()()()()()()()}t&2&&(a(2),D("src","",e.gs.imgUrl,"/close-btn.svg",y),a(4),_("formGroup",e.form),a(10),D("src","",e.gs.imgUrl,"/dropdown-arrow.svg",y),a(2),k(e.TypeOfRequestArray),a(10),_("appLadda",e.loading))},dependencies:[$,G,L,M,O,P,j,X,de,Q,Z,ce,me,H,Y,W,B,z,K]});let r=l;return r})();function he(r,l){if(r&1){let s=w();o(0,"li")(1,"a",23),p("click",function(){let e=C(s).$implicit,c=S();return b(c.form.patchValue({type_of_request:e.value}))}),u(2),n()()}if(r&2){let s=l.$implicit;a(2),q(s.value)}}function ve(r,l){if(r&1&&(o(0,"div",24),u(1),n()),r&2){let s=S();a(1),ie(" ",s.gs.maxLength-(s.form.value==null||s.form.value.description==null?null:s.form.value.description.length)," characters left ")}}function Ce(r,l){r&1&&(o(0,"div"),u(1),n()),r&2&&(a(1),q("Attachment is required"))}function be(r,l){if(r&1&&(o(0,"div",25),N(1,Ce,2,1,"div"),n()),r&2){let s=S();a(1),A(1,s.f.doc_id.errors&&s.f.doc_id.errors.required?1:-1)}}var Me=(()=>{let l=class l{get f(){return this.form.controls}constructor(d,t,e){this.gs=d,this.activeModal=t,this.itemService=e,this.catalog=null,this.user=null,this.submitted=!1,this.Enums=E,this.TypeOfRequestArray=h.CatalogRefRequestTypeArray}ngOnInit(){this.formValidation()}formValidation(){this.form=this.gs.formBuilder.group({user_id:new i(""),contact_id:new i(""),location_id:new i(""),type_of_request:new i("",[m.required]),description:new i("",[m.required,m.maxLength(this.gs.maxLength)]),doc_id:new i(0),relation:new i(this.user?.role===E.ROLE_OWNER?h.USER_CATALOG_ROLE_OWNER:h.USER_CATALOG_ROLE_MANAGER),name:new i(""),email:new i(""),gender:new i(""),date_of_birth:new i(""),telephone:new i(""),status:new i(E.USER_PROFILE_CONTACT_STATUS_PENDING,[m.required])})}onSubmit(d){if(console.log("dfgdfgdf",d.value),this.submitted=!0,!this.form.valid){this.gs.validateAllFormFields(this.form),this.submitted=!1;return}let t=R({},d.value);t.user_id=this.gs.identity?.id,t.contact_id=this.user?.id,t.location_id=this.user?.location?.id,t.name=this.gs.identity?.name,t.email=this.gs.identity?.email,t.gender=this.gs.identity?.userProfile.gender,t.date_of_birth=this.gs.identity?.userProfile.date_of_birth,t.telephone=this.gs.identity?.userProfile.telephone,console.log("params",t),this.itemService.contact("POST",{form:t},null).subscribe(e=>{let c=e.data;this.submitted=!1,this.gs.alert(`You have successfully sent a contact request to the Property ${this.user?.role}`),this.gs.store.dispatch(le.ProfileParams({method:"GET",params:null,params2:{primary_id:this.gs.identity?.id},key:"load_profile"})),this.gs.router(`/requests/contact/view/${c?.id}`),this.dismiss()},e=>{this.submitted=!1})}dismiss(){this.activeModal.close()}};l.\u0275fac=function(t){return new(t||l)(f(ee),f(J),f(te))},l.\u0275cmp=I({type:l,selectors:[["app-catalog-contact-request-dialog"]],inputs:{catalog:"catalog",user:"user"},standalone:!0,features:[V],decls:28,vars:15,consts:[[1,"modal-body"],["type","button",1,"close",3,"click"],["alt","Close",3,"src"],[1,"formdiv"],[3,"formGroup","ngSubmit"],[1,"form-group"],["controlErrorContainer","",1,"input-group"],["type","text","formControlName","type_of_request","placeholder","Type of Request","name","Type of requests","readonly","",1,"form-control",3,"click"],["id","basic-addon2",1,"input-group-text"],["ngbDropdown",""],["myDrop","ngbDropdown"],["type","button","ngbDropdownToggle","","ngbDropdownAnchor",""],[1,"name"],["alt","",3,"src"],["ngbDropdownMenu",""],[1,"form-group-1"],["placeholder","Description","name","Description","cols","30","rows","10","formControlName","description",1,"form-control",3,"maxlength"],["class","crtcount"],[1,"form-group","filesupload"],["title","",3,"layout","browseLabel","multiple","accept","hint","checkExtensions","extensions","getFileId"],["class","invalid-feedback d-block"],[1,"btndiv"],["type","submit",1,"btn","btn-primary",3,"appLadda"],["ngbDropdownItem","",3,"click"],[1,"crtcount"],[1,"invalid-feedback","d-block"]],template:function(t,e){if(t&1){let c=w();o(0,"div",0)(1,"button",1),p("click",function(){return e.dismiss()}),g(2,"img",2),n(),o(3,"h1"),u(4,"Contact Request"),n(),o(5,"div",3)(6,"form",4),p("ngSubmit",function(){return e.onSubmit(e.form)}),o(7,"div",5)(8,"div",6)(9,"input",7),p("click",function(){C(c);let T=U(12);return b(T.open())}),n(),o(10,"span",8)(11,"div",9,10)(13,"button",11)(14,"span",12),g(15,"img",13),n()(),o(16,"ul",14),F(17,he,3,1,"li",null,x),n()()()()(),o(19,"div",15),g(20,"textarea",16),N(21,ve,2,1,"div",17),n(),o(22,"div",18)(23,"app-file-drag-drop-uploader",19),p("getFileId",function(T){return e.form.patchValue({doc_id:T[0]})}),n(),N(24,be,2,1,"div",20),n(),o(25,"div",21)(26,"button",22),u(27),n()()()()()}t&2&&(a(2),D("src","",e.gs.imgUrl,"/close-btn.svg",y),a(4),_("formGroup",e.form),a(9),D("src","",e.gs.imgUrl,"/dropdown-arrow.svg",y),a(2),k(e.TypeOfRequestArray),a(3),oe("maxlength",e.gs.maxLength),a(1),A(21,e.form.value!=null&&e.form.value.description?21:-1),a(2),_("layout","inline")("browseLabel","+ Add attachment...")("multiple",!1)("accept",".xlsx,.xls,image/*,.doc, .docx,.ppt, .pptx,.pdf")("hint","Accepted file formats: .pdf, .docx, .xls, .png, .jpeg.")("checkExtensions",!0)("extensions","image_doc"),a(1),A(24,e.gs.isValid("doc_id",e.f)?24:-1),a(2),_("appLadda",e.submitted),a(1),ie(" ",(e.user==null?null:e.user.in_contact)===e.Enums.USER_PROFILE_CONTACT_STATUS_DECLINED?"Re-Submit":"Send"," "))},dependencies:[ne,$,G,L,M,O,re,P,j,ae,K,X,Q,Z,H,Y,W,B,z,se]});let r=l;return r})();export{Re as a,Me as b};
